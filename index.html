<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì…í•™ì êµìœ¡ê³¼ì • ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>

<body class="bg-gray-100 min-h-screen">
  <div class="max-w-4xl mx-auto py-10">
    <h1 class="text-3xl font-bold mb-8 text-center">ì…í•™ì êµìœ¡ê³¼ì • ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>

    <!-- ì—…ë¡œë“œ ì¹´ë“œ -->
    <div class="bg-white shadow p-6 rounded-lg mb-10">
      <h2 class="text-xl font-semibold mb-4">ğŸ“¤ êµìœ¡ê³¼ì • ì—…ë¡œë“œ</h2>

      <div class="grid grid-cols-1 gap-4 mb-4">
        <input id="dept" type="text" placeholder="í•™ê³¼ëª… ì…ë ¥" class="border p-2 rounded">
        <input id="year" type="number" placeholder="ì…í•™ë…„ë„ ì…ë ¥ (ì˜ˆ: 2026)" class="border p-2 rounded">
        <input id="docNum" type="text" placeholder="ë¬¸ì„œë²ˆí˜¸ ì…ë ¥ (ì˜ˆ: êµìœ¡ê³¼ì •-2026-01)" class="border p-2 rounded">
        <input id="revDocNum" type="text" placeholder="ìˆ˜ì • ë¬¸ì„œë²ˆí˜¸ (ìˆ˜ì • ì‹œë§Œ ì…ë ¥)" class="border p-2 rounded">

        <label class="flex items-center space-x-2">
          <input id="approved" type="checkbox" class="w-4 h-4">
          <span>êµìœ¡ê³¼ì •ìœ„ì›íšŒ í™•ì •ë¨</span>
        </label>
      </div>

      <input id="fileInput" type="file" accept=".xlsx,.xls" class="border p-2 rounded w-full mb-4">

      <button onclick="uploadCurriculum()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        ì—…ë¡œë“œ
      </button>
    </div>

    <!-- Index Table -->
    <div class="bg-white shadow p-6 rounded-lg">
      <h2 class="text-xl font-semibold mb-4">ğŸ“š ì „ì²´ êµìœ¡ê³¼ì • INDEX</h2>
      <table class="w-full text-left border">
        <thead class="bg-gray-200">
          <tr>
            <th class="border p-2">í•™ê³¼</th>
            <th class="border p-2">í•™ë…„ë„</th>
            <th class="border p-2">ë¬¸ì„œë²ˆí˜¸</th>
            <th class="border p-2">ìˆ˜ì •ë¬¸ì„œ</th>
            <th class="border p-2">í™•ì •ì—¬ë¶€</th>
          </tr>
        </thead>
        <tbody id="indexTable"></tbody>
      </table>
    </div>
  </div>

<script>
function loadIndex() {
  const data = JSON.parse(localStorage.getItem("curriculumIndex") || "[]");
  const tbody = document.getElementById("indexTable");
  tbody.innerHTML = "";

  data.forEach(item => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td class="border p-2">${item.dept}</td>
      <td class="border p-2">${item.year}</td>
      <td class="border p-2">${item.docNum}</td>
      <td class="border p-2">${item.revDocNum || "-"}</td>
      <td class="border p-2">${item.approved ? "âœ” í™•ì •" : "ë¯¸í™•ì •"}</td>
    `;
    tbody.appendChild(tr);
  });
}

function uploadCurriculum() {
  const dept = document.getElementById("dept").value;
  const year = document.getElementById("year").value;
  const docNum = document.getElementById("docNum").value;
  const revDocNum = document.getElementById("revDocNum").value;
  const approved = document.getElementById("approved").checked;
  const file = document.getElementById("fileInput").files[0];

  if (!dept || !year || !docNum || !file) {
    alert("í•™ê³¼, í•™ë…„ë„, ë¬¸ì„œë²ˆí˜¸, íŒŒì¼ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const workbook = XLSX.read(e.target.result, { type: "binary" });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const json = XLSX.utils.sheet_to_json(sheet);

    // ì €ì¥í•  ë°ì´í„° êµ¬ì¡°
    const entry = {
      uploadDate: new Date(),
      dept,
      year,
      docNum,
      revDocNum,
      approved,
      data: json
    };

    let index = JSON.parse(localStorage.getItem("curriculumIndex") || "[]");
    index.push(entry);
    localStorage.setItem("curriculumIndex", JSON.stringify(index));

    alert("ì—…ë¡œë“œ ì™„ë£Œ!");
    loadIndex();
  };
  reader.readAsBinaryString(file);
}

loadIndex();
</script>

</body>
</html>
